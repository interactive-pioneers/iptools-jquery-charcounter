/*! iptools-jquery-charcounter - v0.0.1 - 2015-06-10
* https://github.com/interactive-pioneers/iptools-jquery-charcounter
* Copyright Â© 2015 Interactive Pioneers GmbH; Licensed GPL */
!function(a){"use strict";function b(b,e){this.$element=a(b),this.settings=a.extend({},d,e),this._defaults=d,this._name=c,this.init()}var c="iptCharCounter",d={defaultMaxLength:1e3,addModifierClass:!0,elementModifierClass:"textarea--with-counter",addWrapper:!0,wrapperClass:"textarea-wrapper",counterClass:"textarea-counter",warningLimit:30,warningClass:"textarea-counter--warning"};b.prototype={init:function(){this.maxChars=parseInt(this.$element.data("max-length"),10)||this.settings.defaultMaxLength,this.text=this.readInput();var b=this.getRemainingChars();this.$counter=a('<div class="'+this.settings.counterClass+'">'+b+"</div>"),this.settings.addWrapper?(this.$wrapper=this.$element.wrap('<div class="'+this.settings.wrapperClass+'"></div>').parent(),this.$counter.appendTo(this.$wrapper)):this.$element.after(this.$counter),this.$element.addClass(this.settings.elementModifierClass),this.addEventListeners()},readInput:function(){return this.$element.val()},getRemainingChars:function(){var a=this.text.length;return this.maxChars-a},handleChange:function(a){var b=a.data,c=b.readInput();if(b.text!==c){b.text=c;var d=b.getRemainingChars();0>d&&(d=0,c=c.substr(0,b.maxChars),b.text=c,b.$element.val(c)),d<=b.settings.warningLimit?b.$counter.addClass(this.settings.warningClass):b.$counter.removeClass(this.settings.warningClass),b.$counter.text(d)}},handleChangeWithDelay:function(a){var b=a.data;setTimeout(function(){b.handleChange(a)},100)},addEventListeners:function(){var a="change."+this._name+" keyup."+this._name+" paste."+this._name;this.$element.on(a,null,this,this.handleChangeWithDelay)},destroy:function(){var a="change."+this._name+" keyup."+this._name+" paste."+this._name;this.$element.off(a),this.$element.removeData("plugin_"+c)}},a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})}}(jQuery);